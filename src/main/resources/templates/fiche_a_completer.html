<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr" xml:lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <script src="/js/jquery-3.2.1.slim.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <link href="/css/bootstrap.min.css" rel="stylesheet" />
    <script src="/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/css/font-awesome.min.css" />
    <title>Créer une Fiche</title>
    <link rel="icon" type="image/x-icon"
        href="https://upload.wikimedia.org/wikipedia/commons/e/e9/Minsk_Metro_Line_3.png" />


    <style>
        .card-block {
            padding: 10px;
        }

        .scrollcards {
            background-color: #fff;
            overflow: auto;
            white-space: nowrap;
        }


        div.scrollcards .card {
            display: inline-block;
            padding: 14px;
            text-decoration: none;
            height: auto;
            margin-bottom: 1rem;

        }

        .logo {
            width: 1.5rem;
            height: 1.5rem;
        }

        .imageSlider {
            max-height: 10vh;
            max-width: 100%;
            object-fit: contain;
        }

        .imageListe {
            max-height: 20vh;
            max-width: 100%;
            object-fit: contain;
            margin: 1rem;
        }

        .images-selector {
            display: none;
            height: fit-content;
            max-height: 80vh;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            position: fixed;
            top: 5%;
            left: 5%;
            right: 5%;
            bottom: 5%;
            background-color: rgb(255, 255, 255);
            z-index: 999;
            overflow: auto;
            grid-template-columns: repeat(3, 1fr);
            max-width: 85vw;
            margin: 0 auto;
            border-radius: 3%;
        }
    </style>

</head>

<body>
    <div class="container">
        <section class="h-100 p-5 text-white bg-dark rounded-3" style="margin-top: calc(var(--bs-gutter-x) * .5);">
            <div class="container">
                <h1 class="display-4">CREER UNE NOUVELLE FICHE D'INTERVENTION
                </h1>
            </div>
        </section>


        <form th:action="@{/ajouter_fiche}" th:object="${fiche}" method="post" id="ficheForm" class="fiche-form">


            <div class="titre">Selectionner l'intervenant</div>
            <div class="test">
                <select class="form-select" id="utilisateur" name="utilisateur.id" th:field="*{utilisateur.id}">
                    <option th:each="user : ${users}" th:value="${user.id}"
                        th:text="${user.nom} + ' ' + ${user.prenom}"></option>
                </select>
            </div>

            <!--------------------------Intervenant--------------------------------------->
            <hr />


            <legend>
                <div class="row align-items-center">
                    <div class="col-auto d-flex align-items-center">
                        <button class="btn d-flex align-items-center" type="button" data-bs-toggle="collapse"
                            data-bs-target="#imageNiveauIntervenant" aria-expanded="false"
                            aria-controls="imageNiveauIntervenant">
                            <img id="ImageAAfficherOuNonIntervenant" class="display-5 imageIcon" src="/images/check.png"
                                alt="Fait" style="height: 1em;" />
                            <h2 id="TitreSAAfficherOuNonIntervenant" class="display-5 TitreSection">Intervenant</h2>
                        </button>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="collapse multi-collapse" id="imageNiveauIntervenant">
                                <div class="card card-body">
                                    <div class="row">
                                        <div class="col">

                                            <fieldset>
                                                <div>
                                                    <div class="titre">Niveau Titre</div>
                                                    <div class="test">
                                                        <select class="selectTitreIcTxt" id="niveauTitreIntervenant"
                                                            name="niveauTitreIntervenant"
                                                            th:field="${fiche.Intervenant.niveauTitreIntervenant}"
                                                            onchange="updateTitre('Intervenant')">
                                                            <option value="0">Icone</option>
                                                            <option value="1" selected>Icone et texte</option>
                                                            <option value="2">Texte</option>
                                                        </select>
                                                    </div>

                                                </div>
                                            </fieldset>
                                        </div>
                                        <div class="col">
                                            <div class="titre">Couleur Texte</div>
                                            <input type="color" class="colorPicker" value="#000000">
                                            <input type="hidden" id="titlehidden" class="titlehidden"
                                                th:field="*{Intervenant.couleurTitreIntervenant}" />
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <section>
                                                <div class="titre">Icone</div>
                                                <div class="row">
                                                    <div class="scrollcards">
                                                        <div class="card"
                                                            th:each="imageTitre, stat : ${imagesTitreIntervenant}">
                                                            <input class="form-check-input" type="radio"
                                                                name="selectedImageIntervenant"
                                                                th:id="${imageTitre.nomImage}"
                                                                th:value="${imageTitre.nomImage}"
                                                                th:checked="${stat.first}"
                                                                onchange="actualiserImageTitre('Intervenant')">
                                                            <label class="form-check-label"
                                                                th:for="${imageTitre.nomImage}">
                                                                <img class="imageSlider"
                                                                    th:src="@{'/' + ${imageTitre.imageUrl}}"
                                                                    alt="Image Titre" oncontextmenu="return false;"
                                                                    draggable="false" />
                                                                <div class="text-wrap" style="width: min-content;">
                                                                    <h6 th:text="${imageTitre.nomImage}"></h6>
                                                                </div>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>

                                                <input type="hidden" id="imageHiddenIntervenant"
                                                    class="imageHiddenIntervenant"
                                                    th:field="*{Intervenant.imageTitreIntervenantUrl}"
                                                    value="/images/eleve.png" />
                                            </section>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </legend>


            <div class="row">
                <div class="col-md-6 mb-3">
                    <button class="btn d-flex align-items-center" type="button" data-bs-toggle="collapse"
                        data-bs-target="#couleurPrenom" aria-expanded="false" aria-controls="couleurPrenom">
                        <label class="TitreSection" for="firstName" style="cursor: pointer;">Prénom</label>
                    </button>
                    <div class="col">
                        <div class="collapse multi-collapse" id="couleurPrenom">
                            <div class="card card-body">
                                <div class="titre">Couleur Prénom</div>
                                <input type="color" class="colorPicker" value="#000000">
                                <input type="hidden" id="titlehidden" class="titlehidden"
                                    th:field="*{Intervenant.couleurPrenom}" />
                            </div>
                        </div>
                    </div>
                    <input type="text" class="form-control" id="firstName" placeholder="" disabled>
                </div>
                <div class="col-md-6 mb-3">
                    <button class="btn" type="button" data-bs-toggle="collapse" data-bs-target="#couleurNom"
                        aria-expanded="false" aria-controls="couleurNom">
                        <label class="TitreSection" for="lastName" style="cursor: pointer;">Nom</label>
                    </button>
                    <div class="col">
                        <div class="collapse multi-collapse" id="couleurNom">
                            <div class="card card-body">
                                <div class="titre">Couleur Nom</div>
                                <input type="color" class="colorPicker" value="#000000">
                                <input type="hidden" id="titlehidden" class="titlehidden"
                                    th:field="*{Intervenant.couleurNom}" />
                            </div>
                        </div>
                    </div>
                    <input type="text" class="form-control" id="lastName" placeholder="" disabled>
                </div>
            </div>

            <!--------------------------Demande--------------------------------------->

            <legend>
                <div class="row align-items-center">
                    <div class="col-auto d-flex align-items-center">
                        <button class="btn d-flex align-items-center" type="button" data-bs-toggle="collapse"
                            data-bs-target="#imageNiveauDemande" aria-expanded="false"
                            aria-controls="imageNiveauDemande">
                            <img id="ImageAAfficherOuNonDemande" class="display-5 imageIcon" src="/images/check.png"
                                alt="Fait" style="height: 1em;" />
                            <h2 id="TitreSAAfficherOuNonDemande" class="display-5 TitreSection">Demande</h2>
                        </button>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="collapse multi-collapse" id="imageNiveauDemande">
                                <div class="card card-body">
                                    <div class="row">
                                        <div class="col">

                                            <fieldset>
                                                <div>
                                                    <div class="titre">Niveau Titre</div>
                                                    <div class="test">
                                                        <select class="selectTitreIcTxt" id="niveauTitreDemande"
                                                            name="niveauTitreDemande"
                                                            th:field="${fiche.Demande.niveauTitreDemande}"
                                                            onchange="updateTitre('Demande')">
                                                            <option value="0">Icone</option>
                                                            <option value="1">Icone et texte</option>
                                                            <option value="2">Texte</option>
                                                        </select>

                                                    </div>
                                                </div>
                                            </fieldset>
                                        </div>
                                        <div class="col">
                                            <div class="titre">Couleur Texte</div>
                                            <input type="color" class="colorPicker" value="#000000">
                                            <input type="hidden" id="titlehidden" class="titlehidden"
                                                th:field="*{Demande.couleurTitreDemande}" />
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <section>
                                                <div class="titre">Icone</div>
                                                <div class="row">
                                                    <div class="scrollcards">
                                                        <div class="card" th:each="imageTitre, stat : ${imagesTitreDemande}">
                                                            <input class="form-check-input" type="radio"
                                                                name="selectedImageDemande"
                                                                th:id="${imageTitre.nomImage}"
                                                                th:value="${imageTitre.nomImage}"
                                                                th:checked="${stat.first}"
                                                                onchange="actualiserImageTitre('Demande')">
                                                            <label class="form-check-label"
                                                                th:for="${imageTitre.nomImage}">
                                                                <img class="imageSlider"
                                                                    th:src="@{'/' + ${imageTitre.imageUrl}}"
                                                                    alt="Image Titre" oncontextmenu="return false;"
                                                                    draggable="false" />
                                                                <div class="text-wrap" style="width: min-content;">
                                                                    <h6 th:text="${imageTitre.nomImage}"></h6>
                                                                </div>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="hidden" id="imageHiddenDemande" class="imageHiddenDemande"
                                                    th:field="*{Demande.imageTitreDemandeUrl}" />
                                            </section>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </legend>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="disabledNomDemandeur">Nom du demandeur</label>
                    <input type="text" id="disabledNomDemandeur" class="form-control"
                        th:field="*{demande.nomDemandeur}">
                    <label for="disabledDegreUrgence">Degré d'urgence</label>
                    <input type="text" id="disabledDegreUrgence" class="form-control"
                        th:field="*{demande.degreUrgence}">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="disabledDateDemande">Date de la demande</label>
                    <input type="date" id="disabledDateDemande" name="disabledDateDemande" class="form-control"
                        th:field="*{demande.dateDemande}" />

                    <label for="disabledLocalisation">Localisation</label>
                    <input type="text" id="disabledLocalisation" class="form-control"
                        th:field="*{demande.localisation}">
                </div>
            </div>
            <div>
                <div class="form-group">

                    <label for="disabledDescription">Description</label>
                    <textarea rows="10" id="disabledDescription" class="form-control"
                        th:field="*{demande.description}"></textarea>
                </div>
            </div>

            <!--------------------------Intervention--------------------------------------->
            <legend>
                <div class="row align-items-center">
                    <div class="col-auto d-flex align-items-center">
                        <button class="btn d-flex align-items-center" type="button" data-bs-toggle="collapse"
                            data-bs-target="#imageNiveauIntervention" aria-expanded="false"
                            aria-controls="imageNiveauIntervention">
                            <img id="ImageAAfficherOuNonIntervention" class="display-5 imageIcon"
                                src="/images/check.png" alt="Fait" style="height: 1em;" />
                            <h2 id="TitreSAAfficherOuNonIntervention" class="display-5 TitreSection">Intervention</h2>
                        </button>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="collapse multi-collapse" id="imageNiveauIntervention">
                                <div class="card card-body">
                                    <div class="row">
                                        <div class="col">
                                            <fieldset>
                                                <div>
                                                    <div class="titre">Niveau Titre</div>
                                                    <div class="test">
                                                        <select class="selectTitreIcTxt" id="niveauTitreIntervention"
                                                            name="niveauTitreIntervention"
                                                            th:field="${fiche.Intervention.niveauTitreIntervention}"
                                                            onchange="updateTitre('Intervention')">
                                                            <option value="0">Icone</option>
                                                            <option value="1">Icone et texte</option>
                                                            <option value="2">Texte</option>
                                                        </select>

                                                    </div>
                                                </div>
                                            </fieldset>
                                        </div>
                                        <div class="col">
                                            <div class="titre">Couleur Texte</div>
                                            <input type="color" class="colorPicker" value="#000000">
                                            <input type="hidden" id="titlehidden" class="titlehidden"
                                                th:field="*{Intervention.couleurTitreIntervention}" />
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <section>
                                                <div class="titre">Icone</div>
                                                <div class="row">
                                                    <div class="scrollcards">
                                                        <div class="card" th:each="imageTitre, stat : ${imagesTitreIntervention}">
                                                            <input class="form-check-input" type="radio"
                                                                name="selectedImageIntervention"
                                                                th:id="${imageTitre.nomImage}"
                                                                th:value="${imageTitre.nomImage}"
                                                                th:checked="${stat.first}"
                                                                onchange="actualiserImageTitre('Intervention')">
                                                            <label class="form-check-label"
                                                                th:for="${imageTitre.nomImage}">
                                                                <img class="imageSlider"
                                                                    th:src="@{'/' + ${imageTitre.imageUrl}}"
                                                                    alt="Image Titre" oncontextmenu="return false;"
                                                                    draggable="false" />
                                                                <div class="text-wrap" style="width: min-content;">
                                                                    <h6 th:text="${imageTitre.nomImage}"></h6>
                                                                </div>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="hidden" id="imageHiddenIntervention" class="imageHiddenIntervention"
                                                    th:field="*{Intervention.imageTitreInterventionUrl}" />
                                            </section>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </legend>

            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="newDateIntervention">Date de
                        l'intervention</label>
                    <input type="date" id="newDateIntervention" name="newDateIntervention" class="form-control"
                        th:field="*{intervention.dateIntervention}" />
                    <label for="newDureeIntervention">Durée de
                        l'intervention</label>
                    <input type="text" id="newDureeIntervention" name="newDureeIntervention" class="form-control"
                        th:field="*{intervention.dureeIntervention}">
                </div>


                <div class="col-md-4 mb-3">
                    <label for="disabledTypeIntervention">Type d'intervention</label>
                    <div id="disabledTypeIntervention"
                        th:each="nature : ${T(com.webapp.ytb.webappytp.modele.ElementsFiche.Intervention.TypeIntervention).values()}">
                        <div class="media form-check">
                            <input class="form-check-input" type="radio" name="intervention" th:value="${nature.name()}"
                                th:id="${'radio-' + nature}" th:field="*{intervention.TypeIntervention}" />
                            <img class="align-self-start mr-3 logo"
                                th:src="${'/images/' + nature.name().toLowerCase() + '.png'}"
                                th:alt="${'/images/' + nature.name().toLowerCase() + '.png'}" />
                            <label th:for="${'radio-' + nature}"
                                th:text="${#strings.capitalize(nature.name().toLowerCase().replace('_', ' '))}"></label>
                        </div>
                    </div>
                </div>


                <div class="col-md-4 mb-3">
                    <label for="newMaintenanceType">Type de
                        maintenance</label>
                    <div id="newMaintenanceType"
                        th:each="type : ${T(com.webapp.ytb.webappytp.modele.ElementsFiche.Maintenance.MaintenanceType).values()}">
                        <div class="media form-check">
                            <input class="form-check-input" type="radio" name="maintenanceType" th:value="${type}"
                                th:id="${'radio-' + type.name()}" th:field="*{maintenance.maintenanceType}" />
                            <img class="align-self-start mr-3 logo"
                                th:src="${'/images/' + type.name().toLowerCase() + '.png'}"
                                th:alt="${'/images/' + type.name().toLowerCase() + '.png'}">
                            <label th:for="${'radio-' + type.name()}"></label>
                        </div>
                    </div>
                </div>



            </div>

            <!--------------------------Travaux réalisés--------------------------------------->
            <hr />

            <legend>
                <div class="row align-items-center">
                    <div class="col-auto d-flex align-items-center">
                        <button class="btn d-flex align-items-center" type="button" data-bs-toggle="collapse"
                            data-bs-target="#imageNiveauTravauxRealises" aria-expanded="false"
                            aria-controls="imageNiveauTravauxRealises">
                            <img id="ImageAAfficherOuNonTravauxRealises" class="display-5 imageIcon" src="/images/check.png"
                                alt="Fait" style="height: 1em;" />
                            <h2 id="TitreSAAfficherOuNonTravauxRealises" class="display-5 TitreSection">Travaux réalisés</h2>
                        </button>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="collapse multi-collapse" id="imageNiveauTravauxRealises">
                                <div class="card card-body">
                                    <div class="row">
                                        <div class="col">
                                            <fieldset>
                                                <div>
                                                    <div class="titre">Niveau Titre</div>
                                                    <div class="test">
                                                        <select class="selectTitreIcTxt" id="niveauTitreTravauxRealises"
                                                            name="niveauTitreTravauxRealises"
                                                            th:field="${fiche.niveauTravauxRealises}"
                                                            onchange="updateTitre('TravauxRealises')">
                                                            <option value="0">Icone</option>
                                                            <option value="1">Icone et texte</option>
                                                            <option value="2">Texte</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </div>
                                        <div class="col">
                                            <div class="titre">Couleur Texte</div>
                                            <input type="color" class="colorPicker" value="#000000">
                                            <input type="hidden" id="titlehidden" class="titlehidden"
                                                th:field="*{couleurTravauxRealises}" />
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <section>
                                                <div class="titre">Icone</div>
                                                <div class="row">
                                                    <div class="scrollcards">
                                                        <div class="card" th:each="imageTitre, stat : ${imagesTitreTravauxRealises}">
                                                            <input class="form-check-input" type="radio"
                                                                name="selectedImageTravauxRealises"
                                                                th:id="${imageTitre.nomImage}"
                                                                th:value="${imageTitre.nomImage}"
                                                                th:checked="${stat.first}"
                                                                onchange="actualiserImageTitre('TravauxRealises')">
                                                            <label class="form-check-label"
                                                                th:for="${imageTitre.nomImage}">
                                                                <img class="imageSlider"
                                                                    th:src="@{'/' + ${imageTitre.imageUrl}}"
                                                                    alt="Image Titre" oncontextmenu="return false;"
                                                                    draggable="false" />
                                                                <div class="text-wrap" style="width: min-content;">
                                                                    <h6 th:text="${imageTitre.nomImage}"></h6>
                                                                </div>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="hidden" id="imageHiddenTravauxRealises" class="imageHiddenTravauxRealises"
                                                    th:field="*{imageTitreTravauxRealisesUrl}" />
                                            </section>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <textarea rows="10" id="newTravauxRealises" class="form-control" name="newTravauxRealises"
                            onkeydown="handleDescriptionKeyDown(event)"></textarea>
                    </div>
                </div>
            </legend>

            <!--------------------------Travaux NON réalisés--------------------------------------->
            <legend>
                <div class="row align-items-center">
                    <div class="col-auto d-flex align-items-center">
                        <button class="btn d-flex align-items-center" type="button" data-bs-toggle="collapse"
                            data-bs-target="#imageNiveauTravauxNonRealises" aria-expanded="false"
                            aria-controls="imageNiveauTravauxNonRealises">
                            <img id="ImageAAfficherOuNonTravauxNonRealises" class="display-5 imageIcon" src="/images/check.png"
                                alt="Fait" style="height: 1em;" />
                            <h2 id="TitreSAAfficherOuNonTravauxNonRealises" class="display-5 TitreSection">Travaux non réalisés
                            </h2>
                        </button>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="collapse multi-collapse" id="imageNiveauTravauxNonRealises">
                                <div class="card card-body">
                                    <div class="row">
                                        <div class="col">
                                            <fieldset>
                                                <div>
                                                    <div class="titre">Niveau Titre</div>
                                                    <div class="test">
                                                        <select class="selectTitreIcTxt" id="niveauTitreTravauxNonRealises"
                                                            name="niveauTitreTravauxNonRealises"
                                                            th:field="${fiche.niveauTravauxNonRealises}"
                                                            onchange="updateTitre('TravauxNonRealises')">
                                                            <option value="0">Icone</option>
                                                            <option value="1">Icone et texte</option>
                                                            <option value="2">Texte</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </div>
                                        <div class="col">
                                            <div class="titre">Couleur Texte</div>
                                            <input type="color" class="colorPicker" value="#000000">
                                            <input type="hidden" id="titlehidden" class="titlehidden"
                                                th:field="*{couleurTravauxNonRealises}" />
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <section>
                                                <div class="titre">Icone</div>
                                                <div class="row">
                                                    <div class="scrollcards">
                                                        <div class="card" th:each="imageTitre, stat : ${imagesTitreTravauxNonRealises}">
                                                            <input class="form-check-input" type="radio"
                                                                name="selectedImageTravauxNonRealises"
                                                                th:id="${imageTitre.nomImage}"
                                                                th:value="${imageTitre.nomImage}"
                                                                th:checked="${stat.first}"
                                                                onchange="actualiserImageTitre('TravauxNonRealises')">
                                                            <label class="form-check-label"
                                                                th:for="${imageTitre.nomImage}">
                                                                <img class="imageSlider"
                                                                    th:src="@{'/' + ${imageTitre.imageUrl}}"
                                                                    alt="Image Titre" oncontextmenu="return false;"
                                                                    draggable="false" />
                                                                <div class="text-wrap" style="width: min-content;">
                                                                    <h6 th:text="${imageTitre.nomImage}"></h6>
                                                                </div>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="hidden" id="imageHiddenTravauxNonRealises" class="imageHiddenTravauxNonRealises"
                                                    th:field="*{imageTitreTravauxNonRealisesUrl}" />
                                            </section>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <textarea rows="10" id="newTravauxNonRealises" class="form-control" name="newTravauxNonRealises"
                            onkeydown="handleDescriptionKeyDown(event)"></textarea>
                    </div>
                </div>
            </legend>

            <!--------------------------Matériaux--------------------------------------->
            <hr />
            <legend>
                <div class="row align-items-center">
                    <div class="col-auto d-flex align-items-center">
                        <button class="btn d-flex align-items-center" type="button" data-bs-toggle="collapse"
                            data-bs-target="#imageNiveauMateriauxUtilises" aria-expanded="false"
                            aria-controls="imageNiveauMateriauxUtilises">
                            <img id="ImageAAfficherOuNonMateriauxUtilises" class="display-5 imageIcon"
                                src="/images/check.png" alt="Fait" style="height: 1em;" />
                            <h2 id="TitreSAAfficherOuNonMateriauxUtilises" class="display-5 TitreSection">Materiaux
                                utilisés
                            </h2>
                        </button>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="collapse multi-collapse" id="imageNiveauMateriauxUtilises">
                                <div class="card card-body">
                                    <div class="row">
                                        <div class="col">
                                            <fieldset>
                                                <div>
                                                    <div class="titre">Niveau Titre</div>
                                                    <div class="test">
                                                        <select class="selectTitreIcTxt"
                                                            id="niveauTitreMateriauxUtilises"
                                                            name="niveauTitreMateriauxUtilises"
                                                            th:field="${fiche.niveauMateriauxUtilises}"
                                                            onchange="updateTitre('MateriauxUtilises')">
                                                            <option value="0">Icone</option>
                                                            <option value="1">Icone et texte</option>
                                                            <option value="2">Texte</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </div>
                                        <div class="col">
                                            <div class="titre">Couleur Texte</div>
                                            <input type="color" class="colorPicker" value="#000000">
                                            <input type="hidden" id="titlehidden" class="titlehidden"
                                                th:field="*{couleurMateriauxUtilises}" />
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <section>
                                                <div class="titre">Icone</div>
                                                <div class="row">
                                                    <div class="scrollcards">
                                                        <div class="card" th:each="imageTitre, stat : ${imagesTitreMateriauxUtilises}">
                                                            <input class="form-check-input" type="radio"
                                                                name="selectedImageMateriauxUtilises"
                                                                th:id="${imageTitre.nomImage}"
                                                                th:value="${imageTitre.nomImage}"
                                                                th:checked="${stat.first}"
                                                                onchange="actualiserImageTitre('MateriauxUtilises')">
                                                            <label class="form-check-label"
                                                                th:for="${imageTitre.nomImage}">
                                                                <img class="imageSlider"
                                                                    th:src="@{'/' + ${imageTitre.imageUrl}}"
                                                                    alt="Image Titre" oncontextmenu="return false;"
                                                                    draggable="false" />
                                                                <div class="text-wrap" style="width: min-content;">
                                                                    <h6 th:text="${imageTitre.nomImage}"></h6>
                                                                </div>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="hidden" id="imageHiddenMateriauxUtilises" class="imageHiddenMateriauxUtilises"
                                                    th:field="*{imageTitreMateriauxUtilisesUrl}" />
                                            </section>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="materiaux_vertical">

                            <div class="noPrint"></div>
                            <div class="container">
                                <div class="row">
                                    <th:block th:each="sectionNumber : ${#numbers.sequence(0,5)}">
                                        <div class="col-6 col-sm-6 col-lg-4 mb-4 flex-fill ">
                                            <div id="case"
                                                style="border: 2px solid #212529;border-radius: 0.4rem; height: 100%;">
                                                <button type="button" class="btn btn-dark btn-sm" style="width: 100%;">
                                                    Selectionner le matériau
                                                </button>
                                                <div class="w-100"></div>
                                                <img alt="image selectionnée"
                                                    style="max-height: 15vh; max-width: 80vw; width: 100%; object-fit: contain;margin: 1rem;height: inherit;"
                                                    class="rounded mx-auto d-block">
                                                <div class="w-100"></div>
                                                <input type="text" class="form-control mx-auto d-block"
                                                    aria-describedby="basic-addon2">
                                            </div>
                                        </div>
                                </div>
                                </th:block>
                            </div>
                        </div>
                    </div>

                </div>

            </legend>


            <button type="submit">Submit</button>

        </form>
        </main>

    </div>
</body>
<script>
    function actualiserImageTitre(suffixe) {
        // Récupérer l'image sélectionnée
        var selectedImage = document.querySelector('input[name="selectedImage' + suffixe + '"]:checked');
        var imagehidden = document.getElementById('imageHidden' + suffixe);
        if (selectedImage) {
            var selectedImageLabel = document.querySelector('label[for="' + selectedImage.id + '"]');
            var selectedImageSrc = selectedImageLabel.querySelector('img').getAttribute('src');

            // Remplacer l'image ImageAAfficherOuNonSuffixe
            var imageAAfficherOuNonIntervenant = document.getElementById('ImageAAfficherOuNon' + suffixe);
            imageAAfficherOuNonIntervenant.src = selectedImageSrc;
            imagehidden.value = selectedImageSrc;
        }
    }



    function updateTitre(prefix) {
        var selectTitreIcTxt = document.getElementById('niveauTitre' + prefix);
        var niveau = selectTitreIcTxt.value;
        var imageIcon = document.getElementById('ImageAAfficherOuNon' + prefix);
        var titreSection = document.getElementById('TitreSAAfficherOuNon' + prefix);

        switch (niveau) {
            case '0':
                imageIcon.style.display = 'block';
                titreSection.style.display = 'none';
                break;
            case '1':
                imageIcon.style.display = 'block';
                titreSection.style.display = 'block';
                break;
            case '2':
                imageIcon.style.display = 'none';
                titreSection.style.display = 'block';
                break;
        }
    }



    document.addEventListener('DOMContentLoaded', function () {

        //On choisi texte et icone par defaut pour les titres
        var niveauTitreIntervenant = document.getElementById('niveauTitreIntervenant');
        if (niveauTitreIntervenant) {
            niveauTitreIntervenant.value = '1';
        }
        var niveauTitreDemande = document.getElementById('niveauTitreDemande');
        if (niveauTitreDemande) {
            niveauTitreDemande.value = '1';
        }
        var niveauTitreIntervention = document.getElementById('niveauTitreIntervention');
        if (niveauTitreIntervention) {
            niveauTitreIntervention.value = '1';
        }
        var niveauTitreTravaux = document.getElementById('niveauTitreTravaux');
        if (niveauTitreTravaux) {
            niveauTitreTravaux.value = '1';
        }
        var niveauTitreTravauxNon = document.getElementById('niveauTitreTravauxNon');
        if (niveauTitreTravauxNon) {
            niveauTitreTravauxNon.value = '1';
        }
        var niveauTitreMateriauxUtilises = document.getElementById('niveauTitreMateriauxUtilises');
        if (niveauTitreMateriauxUtilises) {
            niveauTitreMateriauxUtilises.value = '1';
        }
        var niveauTitreTravauxRealises = document.getElementById('niveauTitreTravauxRealises');
        if (niveauTitreTravauxRealises) {
            niveauTitreTravauxRealises.value = '1';
        }
        var niveauTitreTravauxNonRealises = document.getElementById('niveauTitreTravauxNonRealises');
        if (niveauTitreTravauxNonRealises) {
            niveauTitreTravauxNonRealises.value = '1';
        }


        var colorPickers = Array.from(document.getElementsByClassName('colorPicker'));
        var titlehiddens = Array.from(document.getElementsByClassName('titlehidden'));
        var titresSection = Array.from(document.getElementsByClassName('TitreSection'));

        colorPickers.forEach((colorPicker, index) => {
            colorPicker.addEventListener('change', function () {
                titlehiddens[index].value = this.value;
                titresSection[index].style.color = this.value;
            });
        });

        //On check la premiere image de chaque section
        actualiserImageTitre('Intervenant');
        actualiserImageTitre('Demande');
        actualiserImageTitre('Intervention');
        actualiserImageTitre('Materiaux');
        actualiserImageTitre('TravauxRealises');
        actualiserImageTitre('TravauxNonRealises');
        actualiserImageTitre('MateriauxUtilises')



        const dateDemandeInput = document.getElementById('dateDemande');

        dateDemandeInput.addEventListener('input', function () {
            let inputValue = dateDemandeInput.value;
            if (inputValue.length === 2 || inputValue.length === 5) {
                inputValue += '/';
            }

            if (inputValue.length > 10) {
                inputValue = inputValue.slice(0, 10);
            }

            dateDemandeInput.value = inputValue;
        });
    });

    // Add this script to format all date inputs when the page is loaded
    document.addEventListener('DOMContentLoaded', function () {
        const dateInputs = document.querySelectorAll('input[type="date"]');
        dateInputs.forEach(function (input) {
            input.value = formatDate(input.value);
        });
    });

    // Function to format date as dd/MM/yyyy
    function formatDate(dateString) {
        const date = new Date(dateString);
        const day = date.getDate().toString().padStart(2, '0');
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const year = date.getFullYear();
        return `${day}/${month}/${year}`;
    }
</script>


</html>