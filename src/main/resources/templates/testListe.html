<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Images Gallery</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #F5F5F5;
        }

        .imageListe {
            max-width: 100px;
            min-width: 100px;
        }

        .images-selector {
            display: none;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        .img-card {
            display: inline-block;
            max-width: 250px;
            height: auto;
            cursor: pointer;
            transition: all 200ms ease-in;
            margin: 5px;
            box-sizing: border-box;
        }

        #selected-image-label {
            margin-top: auto;
            font-weight: bold;
            position: absolute;
            bottom: 10px;
        }
    </style>
</head>

<body>
    <script th:inline="javascript">
        /*<![CDATA[*/
        document.addEventListener('DOMContentLoaded', function () {
            const showMaterialsBtns = document.querySelectorAll('.show-materials-btn');
            showMaterialsBtns.forEach(btn => {
                btn.addEventListener('click', function () {
                    const targetId = this.getAttribute('data-target');
                    const imageSelector = document.getElementById(targetId);
                    imageSelector.style.display = 'flex';
                });
            });

            const imageSelectors = document.querySelectorAll('.images-selector');
            const selectedImageLabels = document.querySelectorAll('[id^="selected-image-label"]');

            imageSelectors.forEach((imageSelector, index) => {
                imageSelector.addEventListener('change', function (event) {
                    if (event.target.type === 'radio') {
                        const selectedMaterial = event.target.value;
                        selectedImageLabels[index].textContent = 'Matériau sélectionné : ' + selectedMaterial;

                        // Masquer les matériaux après la sélection
                        imageSelector.style.display = 'none';
                    }
                });
            });
        });
        /*]]>*/
    </script>

    <!-- Utilisation d'une seule boucle pour générer les sections de la galerie d'images -->
    <th:block th:each="sectionNumber : ${#numbers.sequence(1,6)}">
        <button class="show-materials-btn" th:data-target="'material-dropdown' + ${sectionNumber}">Afficher les matériaux</button>
        <div class="images-selector" th:id="'material-dropdown' + ${sectionNumber}">
            <div th:each="element, status : ${materiauxAmenagementList}">
                <label class="img-card">
                    <img class="imageListe" th:src="${element.emplacementFichier}" alt="Image">
                    <span th:text="${element.optionName}"></span>
                    <input type="radio" name="materialRadio" th:value="${element.optionName}" th:id="'radio_' + ${status.index}">
                </label>
            </div>
        </div>
        <div th:id="'selected-image-label' + ${sectionNumber}"></div>
    </th:block>
</body>

</html>
